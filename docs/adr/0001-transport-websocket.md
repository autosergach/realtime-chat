# ADR 0001: Transport для realtime

## Статус
Принято

## Контекст
Нужен двунаправленный канал для обмена сообщениями, presence и событиями комнат. Рассматривали:
- WebSocket
- SSE
- Long-polling

Критичны двунаправленность, низкая задержка и простая модель событий для чата.

## Решение
Выбираем WebSocket как основной транспорт. Для устойчивости к сетевым ограничениям будем использовать Socket.IO, который поддерживает fallback на polling. В серверной конфигурации оставляем разрешенными транспорты `polling` и `websocket` (дефолт Socket.IO v4).

## Последствия
Плюсы:
- Низкая задержка и двунаправленность для presence/typing.
- Единый контракт событий.
- Устойчивость в средах, где WebSocket недоступен.

Минусы:
- Дополнительный протокольный слой (Socket.IO) вместо «чистого» WebSocket.
- Чуть сложнее наблюдаемость и отладка, чем в HTTP-only подходах.

## Альтернативы
- SSE: проще в реализации, но только сервер -> клиент и требует отдельного канала для client -> server.
- Long-polling: высокая задержка и лишняя нагрузка на сервер, неприемлемо для чата.
